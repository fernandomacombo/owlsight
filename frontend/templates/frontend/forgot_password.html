{% extends "frontend/base.html" %}
{% block title %}Owlsight â€” Esqueceu a senha{% endblock %}

{% block content %}
<div class="max-w-md mx-auto fade-in">
  <div class="glass soft-shadow rounded-3xl p-5">
    <h1 class="text-2xl font-black">Esqueceu a senha</h1>
    <p class="text-sm mt-1" style="color: rgba(255,255,255,.62);">
      Enviamos um link se o email existir.
    </p>

    <div class="mt-4 grid gap-2">
      <input id="email" type="email" class="input px-3 py-2 rounded-xl" placeholder="Seu email" />
      <button id="btn" class="btn-red px-4 py-2 rounded-xl font-semibold">Enviar link</button>
      <p id="msg" class="text-sm" style="color: rgba(255,255,255,.70);"></p>
    </div>

    <div class="mt-4 text-sm">
      <a href="/login/" class="underline" style="color: rgba(255,255,255,.72)">Voltar</a>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.getElementById("btn").onclick = async () => {
  const email = document.getElementById("email").value.trim();
  const msg = document.getElementById("msg");
  msg.textContent = "";

  const res = await fetch("/api/auth/forgot-password/", {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({ email })
  });

  const data = await res.json().catch(() => ({}));
  msg.textContent = data.message || "Se o email existir, enviamos um link.";
};
</script>
{% endblock %}